name: Publish Python Package

on:
  push:
    tags:
      - "v*"  # El workflow se ejecutar치 cuando se empuje un tag que comience con "v"

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
    # Configurar el repositorio
    - name: Checkout repository
      uses: actions/checkout@v3

    # Configurar Python
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.9"

    # Instalar herramientas necesarias para la publicaci칩n
    - name: Install packaging tools
      run: |
        python -m pip install --upgrade pip setuptools wheel twine

    # Construir el paquete
    - name: Build package
      run: |
        python setup.py sdist bdist_wheel

    # Generar una anotaci칩n sobre el paquete construido
    - name: Annotate build success
      run: echo "::notice title=Build Success::The package has been successfully built. Files ready for upload."

    # Subir el paquete a PyPI
    - name: Publish to PyPI
      env:
        TWINE_USERNAME: __token__
        TWINE_PASSWORD: ${{ secrets.PYPI_TOKEN }}
      run: |
        twine upload dist/*
        echo "::notice title=Upload Success::The package has been successfully uploaded to PyPI."

    # Generar una anotaci칩n con los detalles del lanzamiento
    - name: Create release annotation
      run: |
        echo "::notice title=Release Details::Package version ${GITHUB_REF_NAME} has been published to PyPI."
